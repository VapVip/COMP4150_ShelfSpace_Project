<!DOCTYPE html>
<!-- import font -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Write a Review – {{ book.Title }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <!-- top navbar -->
    <div class="navbar">
        <div class="nav-left">
            <a href="{{ url_for('home') }}">Home</a>
            <a href="{{ url_for('books') }}">Books</a>
            <a href="#">About</a>
            <a href="#">Contact</a>
        </div>
        <div class="nav-center">
            <img src="{{ url_for('static', filename='images/logo.png') }}" />
        </div>
        <div class="nav-right">
            {% if not current_user.is_authenticated %}
            <a href="{{ url_for('register') }}">Register</a>
            <a href="{{ url_for('login') }}">Log In</a>
            {% else %}
            {% if current_user.role == 'customer' %}
            <a href="{{ url_for('view_cart') }}" class="cart-link">
                <img src="{{ url_for('static', filename='images/cart-icon.png') }}" alt="Cart" class="cart-icon">
                {% if cart_count and cart_count > 0 %}
                <span class="cart-badge">{{ cart_count }}</span>
                {% endif %}
            </a>
            <a href="{{ url_for('view_wishlist') }}" class="wishlist-link">
                <img src="{{ url_for('static', filename='images/heart-icon.png') }}" alt="Wishlist" class="wishlist-icon">
            </a>
            {% endif %}
            <a href="{{ url_for('account_details') }}">Account</a>
            <a href="{{ url_for('logout') }}">Log Out</a>
            {% endif %}
        </div>
    </div>

    <!-- flash message pop ups -->
    <div class="flash-container">
        {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
        <div class="flash-messages">
            {% for category, message in messages %}
            <div class="flash {{ category }}">{{ message }}</div>
            {% endfor %}
        </div>
        {% endif %}
        {% endwith %}
    </div>

    <!-- main page content -->
    <div class="edit-page">

        <!-- back button -->
        <a href="{{ url_for('book_detail', isbn=book.ISBN) }}" class="back-top-left">← Back to Book Details</a>
        <div class="edit-wrapper">

            <!-- book cover -->
            <div class="edit-image">
                <img src="{{ url_for('static', filename='book_covers/' ~ book.ISBN ~ '.jpg') }}"
                     onerror="this.onerror=null; this.src='{{ url_for('static', filename='book_covers/default.jpg') }}';"
                     alt="Cover for {{ book.Title }}">
            </div>

            <!-- review form -->
            <div class="edit-box">
                <h2>Review for "{{ book.Title }}"</h2>
                <p class="review-author">By: {{ current_user.username }}</p>
                <form method="POST" action="{{ url_for('add_review', isbn=book.ISBN) }}" class="review-form">

                    <!-- star ratings -->
                    <label><strong>Rating:</strong></label>
                    <div class="star-rating">
                        <input type="radio" id="star5" name="rating" value="5">
                        <label for="star5" title="5 stars">★</label>

                        <input type="radio" id="star4" name="rating" value="4">
                        <label for="star4" title="4 stars">★</label>

                        <input type="radio" id="star3" name="rating" value="3">
                        <label for="star3" title="3 stars">★</label>

                        <input type="radio" id="star2" name="rating" value="2">
                        <label for="star2" title="2 stars">★</label>

                        <input type="radio" id="star1" name="rating" value="1">
                        <label for="star1" title="1 star">★</label>
                    </div>

                    <!-- review text box -->
                    <label for="review_text"><strong>Review:</strong></label>
                    <textarea name="review_text" id="review_text" placeholder="Write your review here..." required></textarea>

                    <!-- submit review button -->
                    <div style="margin-top: 15px;">
                        <button type="submit" class="submit-review-btn">Submit Review</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</body>
</html>


