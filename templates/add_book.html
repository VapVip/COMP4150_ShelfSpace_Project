<!DOCTYPE html>
<!-- import font -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Add Book – ShelfSpace</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="page-container">
        <!-- top navbar -->
        <div class="navbar">
            <div class="nav-left">
                <a href="{{ url_for('home') }}">Home</a>
                <a href="{{ url_for('books') }}">Books</a>
                <a href="#">About</a>
                <a href="#">Contact</a>
            </div>
            <div class="nav-center">
                <img src="{{ url_for('static', filename='images/logo.png') }}" alt="ShelfSpace logo">
            </div>
            <div class="nav-right">
                <a href="{{ url_for('account_details') }}">Account</a>
                <a href="{{ url_for('logout') }}">Log Out</a>
            </div>
        </div>

        <!-- flash message pop ups -->
        <div class="flash-container">
            {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
            <div class="flash-messages">
                {% for category, message in messages %}
                <div class="flash {{ category }}">{{ message }}</div>
                {% endfor %}
            </div>
            {% endif %}
            {% endwith %}
        </div>

        <!-- back button -->
        <a href="{{ url_for('books') }}" class="back-top-left">← Back to Book List</a>

        <!-- main page content -->
        <main class="edit-page">
            <div class="edit-wrapper">

                <!-- left column - book cover -->
                <div class="edit-image" style="display: flex; flex-direction: column; align-items: center;">
                    <div class="button-row">
                        <label for="cover" class="upload-btn">Upload Cover</label>
                        <input type="file" id="cover" name="cover" accept="image/*" hidden>
                        <button id="deleteCover" class="delete-cover-btn" type="button">Remove</button>
                    </div>
                    <img id="coverPreview" src="{{ url_for('static', filename='book_covers/default.png') }}" class="cover-preview" alt="Book Cover Preview">
                </div>

                <!-- right column - add form -->
                <div class="edit-box">
                    <h2>Add New Book</h2>
                    <form method="POST" enctype="multipart/form-data" class="edit-form" id="addBookForm">

                        <label for="isbn">ISBN (13 digits)</label>
                        <input type="text" id="isbn" name="isbn" maxlength="13" pattern="\d{13}" required>

                        <label for="title">Title</label>
                        <input type="text" id="title" name="title" required>

                        <label for="author">Author</label>
                        <input type="text" id="author" name="author" required>

                        <label for="genre">Genre</label>
                        <input type="text" id="genre" name="genre" required>

                        <label for="description">Description</label>
                        <textarea id="description" name="description" rows="4" required></textarea>

                        <label for="price">Price ($)</label>
                        <input type="number" id="price" name="price" step="0.01" min="0" required>

                        <label for="stock">Stock Quantity</label>
                        <input type="number" id="stock" name="stock" min="0" required>

                        <button type="submit" class="edit-btn">Add Book</button>
                    </form>
                </div>
            </div>
        </main>
    </div>

    <!-- javascript for cover -->
    <script>
    // cover preview
    const uploadInput = document.getElementById("cover");
    const coverPreview = document.getElementById("coverPreview");
    uploadInput.addEventListener("change", function () {
        if (this.files[0]) {
            coverPreview.src = URL.createObjectURL(this.files[0]);
        }
    });

    // remove cover
    document.getElementById("deleteCover").addEventListener("click", function () {
        uploadInput.value = "";
        coverPreview.src = "{{ url_for('static', filename='book_covers/default.png') }}";
    });

    // form validation for all fields
    document.getElementById("addBookForm").addEventListener("submit", function(e) {
        if (!uploadInput.value.trim()) {
            alert("Please upload a cover image.");
            e.preventDefault();
        }
    });
    </script>
</body>
</html>

